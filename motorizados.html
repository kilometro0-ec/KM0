<!DOCTYPE html>
<html class="dark" lang="es">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Kilómetro 0 - Logística Multi-Pedido</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: { "primary": "#ec1313", "background-dark": "#0a0a0a", "card-dark": "#1c1c1e" },
                    fontFamily: { "display": ["Inter", "sans-serif"] },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        .view-section { display: none; height: 100vh; @apply overflow-y-auto overflow-x-hidden bg-background-dark; }
        .view-section.active { display: block; }
        .ios-blur { backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }
        .route-glow { filter: drop-shadow(0 0 8px rgba(236, 19, 19, 0.6)); }
    </style>
</head>
<body class="font-display text-white">

    <section id="view-tasks" class="view-section active pb-32">
        <header class="p-6 sticky top-0 bg-black/80 ios-blur z-50 border-b border-white/5 flex justify-between items-center">
            <div>
                <p class="text-[10px] font-black text-primary uppercase">Kilómetro 0</p>
                <h1 class="text-2xl font-black italic">PEDIDOS DISPONIBLES</h1>
            </div>
            <span class="bg-emerald-500/10 text-emerald-500 text-[10px] font-black px-3 py-1 rounded-full border border-emerald-500/20">EN LÍNEA</span>
        </header>

        <main class="p-4 space-y-4">
            <div class="flex justify-between items-center px-2">
                <p class="text-[10px] font-bold text-slate-500 uppercase">Selecciona para armar ruta</p>
                <button onclick="clearSelection()" class="text-[10px] font-bold text-primary underline">Limpiar</button>
            </div>

            <div onclick="toggleOrderSelection(this, 'RT-884210')" class="order-card bg-card-dark p-5 rounded-[2rem] border border-white/5 transition-all active:scale-95 cursor-pointer">
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-xl font-black italic">#RT-884210</h3>
                        <p class="text-xs text-slate-400">Rest: Gourmet Burger</p>
                        <p class="text-[10px] text-slate-500 mt-2 flex items-center gap-1">
                            <span class="material-symbols-outlined text-sm text-primary">location_on</span> Av. Principal 123
                        </p>
                    </div>
                    <div class="text-right">
                        <p class="text-lg font-black text-primary">$4.50</p>
                        <div class="selection-indicator size-6 rounded-full border-2 border-white/20 mt-2 flex items-center justify-center"></div>
                    </div>
                </div>
            </div>

            <div onclick="toggleOrderSelection(this, 'RT-884211')" class="order-card bg-card-dark p-5 rounded-[2rem] border border-white/5 transition-all active:scale-95 cursor-pointer">
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-xl font-black italic">#RT-884211</h3>
                        <p class="text-xs text-slate-400">Rest: Pizza Italia</p>
                        <p class="text-[10px] text-slate-500 mt-2 flex items-center gap-1">
                            <span class="material-symbols-outlined text-sm text-primary">location_on</span> Calle Segunda 45
                        </p>
                    </div>
                    <div class="text-right">
                        <p class="text-lg font-black text-primary">$3.80</p>
                        <div class="selection-indicator size-6 rounded-full border-2 border-white/20 mt-2 flex items-center justify-center"></div>
                    </div>
                </div>
            </div>
        </main>

        <div class="fixed bottom-24 inset-x-6 z-50">
            <button id="btn-start-multi" onclick="startMultiRoute()" class="hidden w-full bg-primary h-16 rounded-full font-black text-lg uppercase shadow-2xl shadow-primary/30 flex items-center justify-center gap-3 active:scale-95 transition-all">
                <span class="material-symbols-outlined">alt_route</span> INICIAR MULTI-RUTA (<span id="count-badge">0</span>)
            </button>
        </div>
    </section>

    <section id="view-navigation" class="view-section relative">
        <div class="absolute inset-0 bg-[#0f0f11]">
            <svg class="w-full h-full opacity-30" viewBox="0 0 400 800">
                <path class="route-glow" d="M 200 750 L 200 600 L 100 500 L 300 300 L 200 100" fill="none" stroke="#ec1313" stroke-width="6" stroke-dasharray="10 5" />
                <circle cx="200" cy="750" r="8" fill="#ec1313" class="animate-pulse" /> <circle cx="100" cy="500" r="6" fill="white" /> <circle cx="300" cy="300" r="6" fill="white" /> </svg>
        </div>

        <header class="relative z-10 p-4 bg-black/80 ios-blur flex items-center justify-between">
            <button onclick="switchView('view-tasks')" class="size-10 rounded-full bg-card-dark flex items-center justify-center border border-white/10"><span class="material-symbols-outlined">close</span></button>
            <div class="text-center">
                <p class="text-[10px] font-black text-primary uppercase">Ruta Activa</p>
                <h2 id="nav-title" class="text-sm font-black">2 ENTREGAS PENDIENTES</h2>
            </div>
            <div class="size-10"></div>
        </header>

        <div class="relative z-10 p-4">
            <div class="bg-primary p-5 rounded-3xl shadow-2xl flex items-center gap-4">
                <div class="size-12 bg-white text-primary rounded-full flex items-center justify-center"><span class="material-symbols-outlined text-3xl font-bold">home</span></div>
                <div>
                    <p class="text-[10px] font-black text-white/60 uppercase">Próximo Punto de Entrega</p>
                    <p id="current-stop-addr" class="text-lg font-black leading-tight italic">Av. Principal 123, Torre B</p>
                </div>
            </div>
        </div>

        <div class="absolute bottom-0 inset-x-0 z-10 bg-background-dark/95 p-6 rounded-t-[3rem] border-t border-white/5">
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-white/5 p-4 rounded-2xl">
                    <p class="text-[10px] font-bold text-slate-500 uppercase">Tiempo Total</p>
                    <p class="text-xl font-black italic">22 MIN</p>
                </div>
                <div class="bg-white/5 p-4 rounded-2xl text-right">
                    <p class="text-[10px] font-bold text-slate-500 uppercase">Recorrido</p>
                    <p class="text-xl font-black italic">5.4 KM</p>
                </div>
            </div>
            <button onclick="markStopAsDone()" class="w-full bg-white text-black h-16 rounded-full font-black uppercase shadow-xl flex items-center justify-center gap-2 active:scale-95 transition-all">
                CONFIRMAR ENTREGA ACTUAL <span class="material-symbols-outlined">check_circle</span>
            </button>
        </div>
    </section>

    <nav id="footer-nav" class="fixed bottom-0 inset-x-0 h-20 bg-black/95 ios-blur border-t border-white/10 flex items-center justify-around pb-4 z-[60]">
        <button onclick="switchView('view-tasks')" class="flex flex-col items-center gap-1 text-primary">
            <span class="material-symbols-outlined fill-1">map</span>
            <span class="text-[9px] font-black uppercase">Rutas</span>
        </button>
        <button onclick="alert('Historial de pagos')" class="flex flex-col items-center gap-1 text-slate-500">
            <span class="material-symbols-outlined">payments</span>
            <span class="text-[9px] font-black uppercase">Balance</span>
        </button>
    </nav>

    <script>
        let selectedOrders = [];

        function switchView(id) {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            // Ocultar nav en modo navegación
            const nav = document.getElementById('footer-nav');
            nav.style.transform = (id === 'view-navigation') ? 'translateY(100%)' : 'translateY(0)';
        }

        function toggleOrderSelection(el, orderId) {
            const indicator = el.querySelector('.selection-indicator');
            const index = selectedOrders.indexOf(orderId);

            if (index > -1) {
                selectedOrders.splice(index, 1);
                el.classList.remove('border-primary', 'bg-primary/5');
                indicator.innerHTML = '';
                indicator.classList.remove('bg-primary', 'border-primary');
            } else {
                selectedOrders.push(orderId);
                el.classList.add('border-primary', 'bg-primary/5');
                indicator.innerHTML = '<span class="material-symbols-outlined text-white text-xs">check</span>';
                indicator.classList.add('bg-primary', 'border-primary');
            }

            // Actualizar botón multi-ruta
            const btn = document.getElementById('btn-start-multi');
            const badge = document.getElementById('count-badge');
            if (selectedOrders.length > 0) {
                btn.classList.remove('hidden');
                badge.innerText = selectedOrders.length;
            } else {
                btn.classList.add('hidden');
            }
        }

        function clearSelection() {
            selectedOrders = [];
            document.querySelectorAll('.order-card').forEach(el => {
                el.classList.remove('border-primary', 'bg-primary/5');
                el.querySelector('.selection-indicator').innerHTML = '';
                el.querySelector('.selection-indicator').classList.remove('bg-primary', 'border-primary');
            });
            document.getElementById('btn-start-multi').classList.add('hidden');
        }

        function startMultiRoute() {
            if (selectedOrders.length === 0) return;
            document.getElementById('nav-title').innerText = `${selectedOrders.length} ENTREGAS PENDIENTES`;
            switchView('view-navigation');
        }

        function markStopAsDone() {
            if (selectedOrders.length > 1) {
                selectedOrders.shift();
                document.getElementById('nav-title').innerText = `${selectedOrders.length} ENTREGAS RESTANTES`;
                document.getElementById('current-stop-addr').innerText = "Siguiente parada: Calle Segunda 45";
                alert("Entrega confirmada. ¡Sigue a la siguiente parada!");
            } else {
                alert("¡Ruta completada! Todos los pedidos han sido entregados.");
                selectedOrders = [];
                clearSelection();
                switchView('view-tasks');
            }
        }
    </script>
</body>
</html>
