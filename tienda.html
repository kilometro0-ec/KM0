<!DOCTYPE html>
<html class="dark" lang="es">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>KM0 - Panel Directo</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@400,0..1" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: { extend: { colors: { "primary": "#ec1313", "background-dark": "#120808" } } }
        }
    </script>
</head>
<body class="bg-slate-50 dark:bg-background-dark text-slate-900 dark:text-white min-h-screen">

    <header class="sticky top-0 z-50 bg-white/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-slate-200 dark:border-white/10 px-4 py-4 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="bg-primary p-2 rounded-lg"><span class="material-symbols-outlined text-white text-xl">speed</span></div>
            <h1 class="font-bold text-xl tracking-tight italic">KILÓMETRO 0</h1>
        </div>
        <button class="p-2 bg-slate-100 dark:bg-white/5 rounded-full"><span class="material-symbols-outlined">notifications</span></button>
    </header>

    <main class="p-4 space-y-4 pb-28">
        <div class="flex justify-between items-center">
            <h2 class="text-xs font-bold text-slate-400 uppercase tracking-widest">Pedidos Activos</h2>
            <div class="h-2 w-2 rounded-full bg-primary animate-ping"></div>
        </div>

        <div class="bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-4 shadow-sm">
            <div class="flex justify-between items-start mb-3">
                <span class="text-[10px] font-bold text-slate-500 uppercase">Ref: KM0-NEW</span>
                <span class="text-[10px] font-bold text-primary bg-primary/10 px-2 py-1 rounded">PENDIENTE</span>
            </div>
            <p class="text-sm font-semibold mb-1">Crea un pedido para empezar</p>
            <p class="text-xs text-slate-400">Los nuevos pedidos aparecerán aquí abajo.</p>
        </div>
    </main>

    <nav class="fixed bottom-0 inset-x-0 bg-white/90 dark:bg-background-dark/90 backdrop-blur-lg border-t border-slate-200 dark:border-white/10 px-6 py-4 flex justify-around items-center pb-8">
        <button class="text-primary flex flex-col items-center"><span class="material-symbols-outlined">grid_view</span><span class="text-[10px] font-bold">INICIO</span></button>
        <button onclick="document.getElementById('modalPedido').classList.remove('hidden')" class="size-16 bg-primary rounded-full -mt-12 shadow-lg shadow-primary/40 text-white flex items-center justify-center transition-transform active:scale-90">
            <span class="material-symbols-outlined text-4xl">add</span>
        </button>
        <button class="text-slate-400 flex flex-col items-center"><span class="material-symbols-outlined">analytics</span><span class="text-[10px] font-bold">REPORTES</span></button>
    </nav>

    <div id="modalPedido" class="fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm hidden items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-900 w-full max-w-md rounded-3xl p-6 shadow-2xl animate-in zoom-in duration-200">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold italic">NUEVO ENVÍO</h2>
                <button onclick="document.getElementById('modalPedido').classList.add('hidden')" class="text-slate-400 p-2"><span class="material-symbols-outlined">close</span></button>
            </div>
            
            <form id="formFinal" class="space-y-4">
                <input type="text" id="cliente" placeholder="Nombre del Cliente" class="w-full p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary" required>
                <input type="text" id="direccion" placeholder="Dirección Exacta" class="w-full p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary" required>
                <input type="tel" id="telefono" placeholder="WhatsApp Cliente" class="w-full p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary" required>
                
                <div class="grid grid-cols-2 gap-3">
                    <input type="number" id="valor" placeholder="Valor ($)" class="p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary" required>
                    <select id="ciudad" class="p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary">
                        <option>Quito</option>
                        <option>Guayaquil</option>
                        <option>Cuenca</option>
                        <option>Santo Domingo</option>
                    </select>
                </div>

                <div class="grid grid-cols-3 gap-3">
                    <input type="number" id="cant" placeholder="Cant." class="p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary" required>
                    <input type="text" id="detalle" placeholder="¿Qué es?" class="col-span-2 p-4 rounded-xl bg-slate-100 dark:bg-white/5 border-none focus:ring-2 focus:ring-primary" required>
                </div>

                <button type="submit" id="btnS" class="w-full py-5 bg-primary text-white font-black rounded-2xl shadow-lg shadow-primary/30 active:scale-95 transition-all">ENVIAR A KILÓMETRO 0</button>
            </form>
        </div>
    </div>

    <script>
        const WEB_APP_URL = "TU_URL_DE_GOOGLE_APPS_SCRIPT"; // <--- PEGA TU URL AQUÍ

        document.getElementById('formFinal').onsubmit = async (e) => {
            e.preventDefault();
            const b = document.getElementById('btnS');
            b.innerText = "ENVIANDO...";
            b.disabled = true;

            const d = {
                accion: "NUEVO_PEDIDO",
                tienda: "TIENDA_DIRECTA", 
                ciudad: document.getElementById('ciudad').value,
                cliente: document.getElementById('cliente').value,
                telCliente: document.getElementById('telefono').value,
                direccion: document.getElementById('direccion').value,
                cantidad: document.getElementById('cant').value,
                detalle: document.getElementById('detalle').value,
                valor: document.getElementById('valor').value
            };

            try {
                await fetch(WEB_APP_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(d) });
                alert("✅ PEDIDO RECIBIDO");
                document.getElementById('modalPedido').classList.add('hidden');
                e.target.reset();
            } catch (err) {
                alert("❌ ERROR AL ENVIAR");
            } finally {
                b.innerText = "ENVIAR A KILÓMETRO 0";
                b.disabled = false;
            }
        };
    </script>
</body>
</html>
